/*
*
* jquery.simple.scroller.js
* A query plugin for cross browser compatible scrollbar replacement on html elements.
*
* Copyright 2011, Christopher Finch
* Licensed under the GPL Version 3 license.
*
* Date: Fri 24th november 2011
*
*
* This program is free software: you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program.  If not, see <http://www.gnu.org/licenses/>.
*
*/

(function(a){var b={init:function(b){return this.each(function(){var c=a(this).addClass("simpleScroller-self").css("overflow","hidden"),d=c.data("simpleScroller");if(!d){var e=a.extend({height:c.css("height"),width:c.css("width"),innerHeight:0,offSet:0},b);e.inner=a("<div></div>").addClass("simpleScroller-inner");e.viewPort=a("<div></div>").addClass("simpleScroller-viewport").css({height:e.height,width:e.width});c.wrapInner(e.inner);c.wrapInner(e.viewPort);e.inner=c.find(".simpleScroller-inner");e.viewPort=c.find(".simpleScroller-viewport");e.inner.children().each(function(b,c){e.innerHeight=e.innerHeight+a(c).outerHeight()});e.inner.css("height",e.innerHeight+"px");e.handle=a("<div></div>").addClass("simpleScroller-handle");e.scrollbar=a("<div></div>").addClass("simpleScroller-scrollbar").css("height",e.height).append(e.handle);e.scrollbar.appendTo(e.viewPort);e.handle=c.find(".simpleScroller-handle");e.scrollbar=c.find(".simpleScroller-scrollbar");function f(){e.viewPort.bind("mousewheel",function(a,b){a.preventDefault();amount=b<0?Math.abs(b):b*-1;e.offSet=e.offSet+amount*12;if(0>e.offSet){e.inner.css("top","0px");e.offSet=0}else if(e.offSet>e.innerHeight-e.viewPort.height()){e.inner.css("top","-"+(e.innerHeight-e.viewPort.height())+"px");e.offSet=e.innerHeight-e.viewPort.height()}else{e.inner.css("top","-"+e.offSet+"px")}e.handle.trigger("mwheel")});e.handle.bind("mwheel",function(){var a=Math.floor(e.offSet/(e.innerHeight-e.viewPort.height())*100);e.handle.dragger.css({top:e.handle.maxTop/100*a})})}function g(a){per=Math.floor(a/(e.scrollbar.height()-e.handle.height())*100);return(e.innerHeight-e.viewPort.height())/100*per}function h(a,b){if(b){e.inner.animate({top:"-"+g(a)+"px"})}else{e.inner.css("top","-"+g(a)+"px")}e.offSet=g(a)}function i(){e.handle.dragger=e.handle;e.handle.maxTop=e.scrollbar.height()-e.handle.height();e.handle.bind("mousedown",function(b){b.preventDefault();e.handle.mousePageY=b.pageY,e.handle.dragPos=e.handle.dragger.position().top,e.handle.leftPos,e.handle.topPos;a(document).bind("mousemove mouseup",function(b){switch(b.type){case"mousemove":e.handle.topPos=e.handle.dragPos+b.pageY-e.handle.mousePageY;if(0>e.handle.topPos){e.handle.dragger.css({top:0});h(0)}else if(e.handle.topPos>e.handle.maxTop){e.handle.dragger.css({top:e.handle.maxTop+"px"});h(e.handle.maxTop)}else{e.handle.dragger.css({top:e.handle.topPos});h(e.handle.topPos)}break;case"mouseup":a(this).unbind("mousemove mouseup");break}})})}function j(){e.scrollbar.bind("click",function(a){if(a.originalEvent.originalTarget.className!=e.handle.dragger.attr("class")){e.scrollbar.position=e.scrollbar.offset().top;e.scrollbar.clickPos=a.pageY-e.scrollbar.position;e.scrollbar.max=e.scrollbar.height()-e.handle.dragger.height();e.scrollbar.min=e.handle.dragger.height();if(e.scrollbar.clickPos<e.scrollbar.min){e.handle.dragger.animate({top:"0px"});h(0,true)}else if(e.scrollbar.clickPos>e.scrollbar.max){e.handle.dragger.animate({top:e.scrollbar.max+"px"});h(e.handle.maxTop,true)}else{e.handle.dragger.animate({top:e.scrollbar.clickPos+"px"});h(e.scrollbar.clickPos,true)}}})}i();f();j();c.data("simpleScroller",e)}})}};a.fn.simpleScroller=function(c){if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof c==="object"||!c){return b.init.apply(this,arguments)}else{a.error("Method "+c+" does not exist on jQuery.simpleScroller")}}})(jQuery)